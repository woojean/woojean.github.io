---
layout: post
title:  "《电商产品经理宝典——电商后台系统产品逻辑全解析》读书笔记"
date: 2019-02-19 00:00:01
categories: 运营
tags: 
excerpt: ""
---

* content
{:toc}


# 内容简介
时至今日，对于产品经理的要求趋向业务型、平台型，甚至产生了细分领域专家。纯粹的前端产品经理（页面、交互）逐渐失去竞争力。ᦠ`怀而当后台产品经理的视野开始从功能延伸到模块，再延伸到子系统，最后关注整体系统时，就有了把控平台型产品的能力。


# 前言
伟大的事物不是一时冲动做起来的，而是由一系列小事共同造就的。——梵高


# 第1章　产品经理概述
用户提出来的需求只能称作用户需求，还不能算产品需求。

基于对开发成本的把握，对于每个阶段每个版本能完成哪些需求都要了然于胸。

还有一件事情对于产品经理的职业要求最高，就是“需求变更”。

了解不同人的想法。

对需要做的、已经做的、做完的需求进行整理跟踪，对需求来源、Deadline、进度进行追踪，这个表格就相当于产品经理的工作清单，可以跟踪工作完成度。

优秀的产品经理都具有“场景思考力”，那什么是“场景思考力”呢？就是在具体场景内联想思考的能力，而不是一味空想。

电商产品是最成熟、最典型的系统化产品，从电商产品入门，再去探索其他的产品，就会发现理解起来很容易。

电商行业会带给产品人成熟的体系化思维。

电商行业发展到现在，也遇到了瓶颈。如今流量成本高昂，客户忠诚度低。对很多小平台电商来讲，几乎无复购率，只要停止砸钱做活动、铺广告，订单量就会直线下降。

电子商务的模式总结下来主要有5种类型：B2C、B2B、C2C、C2M、O2O。

B2B（Business to Business）解决的是供应商的上游到中游的问题，B2B模式的优势在于可降低采购成本，节省周转时间，但是企业采购一般要求较高（资质、流程、库存、货款等），需要许多线下沟通。如今B2B平台更多是提供企业之间的信息匹配。移动社交的兴起给C2C电商带来了一定机会，给了C端做分销或个性化商品的环境。淘宝网、微店等都是典型的C2C商城。

C2M（Customer  to  Manufactory）：客户与工厂直接对接，即定制化生产消费。这种模式还解决了库存顽疾这一大问题，将传统的刚性生产模式变成了柔性生产线。未来C2M的利润空间更多的将是定制服务和增值服务。

O2O：指线上到线下，通过互联网连接本地生活服务，解决日常生活中的衣食住行等需求。O2O平台在线上提供生活服务信息，从线上获取信息、购买，到线下享受服务，再到线上评价完成消费的闭环。

马太效应也在电商行业得到了充分的体现，先行者或巨头们过得越来越好，一些追风者企业则消亡了一批又一批。失败点或在供应链的管控上，或在用户流量上，或在资金链断裂上等。



# 第2章　支撑线后台概述
一开始接触后台产品，会觉得异常困难，因为后台不是某个独立系统，而是多个模块组合，并且之间还有信息交互。后台重逻辑、重业务，对产品经理的要求很高，令许多人望而却步。

前端用户的一小步，后台系统的一大步。

做电商产品经理，一定要读供应链管理的相关书籍，用专业化的理论来理解业务。

电商后台产品线的大多数工作是将线下的供应链体系搬到线上，比如采购、仓储、供应商管理、库存管理、商品、售价管理等。

电商公司的采购、仓储、服务、物流、订单等工作都在供应链管理中有所涉及。

电商后台的许多工作是将供应链流程信息化，以系统的方式来控制业务。

现在很多电商公司开始转型社交电商，采用UGC模式或直播电商，在产品架构上会新增资讯系统，实现资讯与商品的高度融合。

SKU（最小库存单位）。

SPU（标准化产品单元）。

内容管理系统：主要是对用户端进行页面配置（Banner、ICON、Tab），配置首页，自定义活动页面，设置生效时效。

评价中心：管理商品评价和用户反馈。这并没有想象的那么简单，涉及一些敏感词和敏感图片的筛选，以及回复内容管理。

采购中心：管理SKU，当库存预警时，及时生成采购单进行入库。

风控中心：主要利用大数据进行用户信用建设、反欺诈，避免恶意评价、刷单退款等操作，构建安全的电商购物环境。

店铺管理：功能庞杂，相当于提供给B端用户一个Saas管理后台，提供管理商品、营销、订单一系列功能，主要针对一些有对B端业务的电商开放平台。

对电商公司来讲，最核心最难做的有三部分：商品、订单、库存。妠A悀商品与店铺、营销、评价等相关；订单与会员、营销、支付、库存、物流等相关；库存与订单、采购、WMS、营销等相关。系统之间业务逻辑和交互异常复杂，规则多样。

后台产品经理的能力很大一部分在于对业务的梳理能力，越到后台发展中后期，业务逻辑会越复杂。对业务进行拆分，定义产品架构，支撑中长期的业务发展，极其考验产品经理的能力。


# 第3章 商品中心
商品中心的数据应用场景很多，在使用的维度上分为前端和后端。从前端来讲，是给商品展示、订单、营销活动提供商品数据支撑；从后端来讲，商品中心给订单发货、仓库管理、供应商管理、采购提供基础数据支撑。

SKU：（Stock Keeping Uint，即库存量单位），库存控制的最小可用单位。

SPU：（Standard  Product  Unit，即标准化产品单元），是一组标准化信息的集合。

类目：即分类树。电商常用的有两层类目：前台展示类目和后端商品类目。前台类目指的是展示给消费者看的类目，会根据季节、销售策略、活动进行变动；后台类目属于基础数据，不可随意变动，添加SKU 时都需要选择后台类目，进行绑定。

属性：分为关键属性、销售属性、非关键属性。关键属性是指能够唯一确定产品的属性，是必填项，例如手机的屏幕尺寸、型号属于关键属性。销售属性是组成SKU的特殊属性，或称为“规格属性”，例如手机的“颜色”、“内存”。非关键属性指的是除关键属性、销售属性外的其他属性，如手机的手机接口类型。非关键属性不一定是非必填项，不过有时为了商品信息完整，也会设为必填项。

现在前、后台类目分离的理念已深入人心。

淘宝、天猫的SKU达到数亿级。

将前、后台类目分离。后台类目面向商家或供应链人员，商品属性、销售属性及品牌等很多数据都是在基础类目上进行管理；前台类目面向用户，方便用户查找商品，还可以随着运营需要去调整。前、后台类目通过映射关联。

后台类目相对固定，确定了之后不会轻易变更或删除，如果类目下挂载有商品，就不能删除或作废。

类目树的层次不能太深，一般三层或四层。如果太深，不论对于管理还是技术性能来说，都是不利的。

赠品作为促销（低价）商品，应该专门设置类目，通常放置到商品发布类目“其他—赠品”类目下，以避免引起买家对该商品的误解，进而避免产生不必要的纠纷。

前台类目主要面向用户，方便用户筛选查找商品。

前台类目可支持不同客户端的设置。PC端、H5端、APP端等渠道由于用户群体有所差异，可分别设置前台类目，独立运营。

支持平台商家自定义店铺前台类目。

前台类目对应后台类目，可一对一、一对多、多对多，自由组合，动态调整。现在大部分自营电商都是用的这种类型。

前台类目对应后台的叶子类目和某项属性的组合。例如分类时选择奶粉中的1段、2段、3段等属性组成类目。

前台类目不同于固定的后台类目，编辑很灵活、可重叠、可删除、可随时变动，定时生效。

将品牌关联到类目上，关系也是一对一、一对多、多对一。

属性是对产品性质的描述，是区分产品差异性的集合。在电商中，属性通常分为关键属性、销售属性、非关键属性、商品属性。

关键属性可以是一个属性，也可以是多个属性的组合。例如：通过手机的“品牌”、“型号”两个属性组合就能确定唯一的产品，这两个就是关键属性；通过服装的“品牌”、“货号”两个属性组合能确定唯一的产品，所以这两个也是关键属性。

销售属性：也称为规格属性。其是组成SKU的特殊属性，它会影响买家的购买和卖家的库存管理。

非关键属性：除关键属性、销售属性外的其他属性。

注意，产品的非关键属性并不包括商品属性。

商品属性：表示商品的特有特征，比如新旧程度、保修方式等，不能作为产品的属性。

属性的定义对于良好的消费体验有着至关重要的意义，对搜索、索引、筛选都能起到至关重要的作用。商品搜索能力，除了标题、类目，很大程度依赖于商品属性，条件筛选的基础数据也是商品属性和规格属性。

为了方便商品管理，我们需要在系统中建立一套属性库，类目属性都是调取的属性库里的数据。

属性编辑主要是定义当前分类的商品具有哪些属性。在属性管理上，有两个产品方法可以使用，属性分组和属性继承。


属性分组：把形容某一类特征的几个属性归属于一个组，如屏幕参数、镜头参数、曝光控制、闪光灯参数等都属于属性分组。

如果网站的商品分类为三个层级，每个商品由很多的商品属性构成，其中同一层级的商品属性可能有很多都是相同的属性，为了减少属性添加时的工作量，我们将这部分共用的属性归类后赋值在上一层级的分类中，依次操作，将归类后的属性分别赋值给上级的分类中。

每一个层级的商品属性继承上一层级的商品属性，将每个层级的属性提取出来，便组成了一个商品的完整的属性表达。

比如实物商品佳能EOS 800D（在类目“数码”→“摄影摄像”→“单反相机”中）就有商品毛重、像素、套头三个属性需要填写。

当属性库搭建完成后，就会被各个叶子类目调用，添加商品时就需要填写这些属性，商品就有了载体，属性库在前台便充当起了导购、描述、筛选的作用。

SPU与SKU的关系有许多种，可以一对多、一对一，绝大部分SPU与SKU都是一对一，多规格的SPU和SKU之间是通过规格属性来连接的。SPU的库存是由其对应的SKU库存共同决定的。


在日常运营中也很常见一个SKU对应多个SPU，例如在一家淘宝店中，同样的一件男裤，店家可以起两个不同的商品名称（“七分裤男夏季薄款纯棉运动休闲”、“7分男士短裤男夏天宽松大码小脚潮”），这时候在前台展示的是不同商品，系统中这两件商品编码（SPU编码）也不同，但是发货对应的是同一个SKU，库存也是共用。

组合SKU，主要是解决出售组合商品的问题。组合SKU的属性都继承主SKU。组合SKU不同于套装促销。套装促销在订单中会展示多个商品，而组合SKU在前台是一个商品。组合SKU的应用场景主要是添加赠品、组合售卖，与前台的商品套餐有所区别。在订单解析成发货单时，组合SKU需解析成单一SKU，方便仓库发货，更新库存。

我国官方的商品编码是69开头，俗称69码，例如食品包装上的条码。在编辑商品的时候，一般会有个条形码字段需要填写，就是系统中的SKU对应69码。这个条形码主要在采购、出入库时使用。

在仓库的条码方案以下有两种：
* 全部自建条码。采用自己的SKU编码管理商品，需要入库前重新贴标，成本较高。
* 有69码的商品沿用69码，无69码的商品（比如蔬菜、生鲜等）以及无法指定到单一的有码商品重新贴SKU编码。在仓库管理时做相应的条码映射。

良好的属性定义对于顾客决策树的缩短有着至关重要的作用。

很多电商公司业务定位都是B2B2C，为了扩充SKU，增加用户量，或者构建平台体系，都会允许第三方来平台管理商品，类似京东、淘宝。这类平台的商品结构更加复杂，SKU需要增加所属商家，商品详情、属性值、库存都需要相互独立，在SKU、SPU纬度上增加一个商家纬度。

淘宝、天猫上的商品以SPU 形态显示，京东上以SKU形态显示，两种处理方式各有优劣势（淘宝切换规格时商品详情不变，京东切换规格时标题及详情会改变）。

系统中的SKU名称和商品名称是有区别的，SKU名称是方便在系统中进行管理流转，而商品名称有一定的营销性质。

平台上会针对商品设置平台价和市场价，平台价主要是当商品具有不同规格、价格时，出现在搜索、筛选列表中只显示一个价格，相当于商品的均价。毛重、长宽高等数据主要是为了物流而设置的，自建仓库的自营电商一般在SKU数据层就会录入这些数据，直接调用。货号即商品编码，在商城购物时会扫描的条形码就是货号。货号不等同于SKU编码，同一商品编码的商品可能是不同SKU，有着不同的规格，所以不能直接拿货号来管理SKU。

商品主图是吸引顾客眼球的必要利器，不论是列表页，还是活动页，顾客除了关注价格，主要就是商品主图，运营上架时需慎重选择商品主图。

商品详情页现在一般会区分电脑版和手机版，由于两者的使用场景和设备不同，侧重点也不相同。为了更好地展示产品特点，可提供不同的产品详情模板，亦可支持富文本编辑。

商品可进行批量上下架；可设置自动下架规则，在缺货（库存为0）时自动下架商品；新品上架可定时发布；活动商品定时上下架等。

在价格管理时，有些电商还会去爬虫收集其他平台在相同商品的价格，以便于在调整价格时的参照。至于动态调价系统，需要制定调价规则，日常生活接触最多的应该是机票、酒店的售价。

搜索是快速找到信息的工具，也是流量的入口。

纠错主要通过建立错词与正确词的映射关系表，在搜索的时候替换。数据来源主要有用户搜索词、搜索日志、运营部门人工更新等。

在商品搜索排序中还会有个性化推荐因素，会根据用户消费轨迹、所在地区来进行个性化推荐。

商品筛选能够建立用户与目标商品的更短路径，从而加快决策进程。商品筛选条件主要有价格区间、品牌、服务、分类、商品属性等。

商品推荐分为常规推荐、个性化推荐。常规推荐是指商家选择一些固定商品放在推荐位，或者基于商品之间的关联性，进行相关的商品推荐。

个性化推荐指基于用户购物习惯，根据商品特性来进行推荐。

常规推荐的商品不会因为用户不同产生差异，主要是根据运营配置的活动或固定商品（商品精选）。

近两年崛起的内容电商也属于商品推荐的一种，很多平台都开始在内容上发力，越来越多的消费者在看直播、看自媒体文章、看帖子的过程中购买商品。例如淘宝的微淘、京东的觅生活（Meelife）、小红书等。

内容电商将商品嵌入到文案或者视频中，通过详细的描述消费感受和商品特点，激起用户的同理心，这样的购物消费更容易产生冲动性消费，而非计划性消费。

在内容电商中，除了平台商家自己产生内容，还应允许用户产生内容（User  Generated  Content，UGC），并且对之进行激励。

建立内容社区，提供评论、关注、种草（收藏）、赞赏等多种互动方式，增加用户黏性，提供分享到其他社交平台（微信、微博等）的功能。在内容中尽量推荐统一风格或同一场景的商品，增加商品之间的关联性。

随着货架式电商时代逐渐过去，内容电商推荐的优势逐步凸显，特别在垂直行业，如美妆、母婴等，内容电商为中小型电商公司突破流量黑洞提供了机会。

用户对推荐结果的点击浏览、购买的反馈结果，又可以作为优化系统推荐的参考。

完善的推荐系统一般由四部分组成：采集用户信息的用户行为记录模块、分析用户喜好的用户行为分析模块、分析商品特征的商品分析模块，以及推荐算法模块。用户行为记录模块负责采集能反映用户喜好的行为，例如浏览、购买、评论、问答等；用户行为分析模块通过用户的行为记录，分析用户对商品的潜在喜好及喜欢程度，建立用户偏好模型；商品分析模块主要对商品进行商品相似度、商品搭配度、目标用户标签进行分析；推荐算法根据一定的规则从备选商品集合中筛选出目标用户最可能感兴趣的商品进行推荐。

构建用户画像的核心工作即是给用户“贴”标签，而标签是通过对用户行为记录分析而来的高度精炼的特征标识。推荐系统的难点，其中很大一部分就在于用户画像的积累过程极其艰难。

商品分析模块主要根据商品的类目品牌、商品属性、产品评论、库存、销售记录、订单数据、浏览收藏、价格等数据来分析商品相似度、商品搭配度（可人工调整），并且对商品贴上目标用户标签。

用户画像、商品分析模块的数据都是为推荐算法提供基础数据。商品推荐的算法有很多种，需要根据推荐结果反馈，不断优化模型。

“购买此商品的顾客也同时购买”、“看过此商品后顾客购买的其他商品”、“经常一起购买的商品”，都是基于商品进行的推荐。

需要注意的是，如果完全按照用户行为数据进行推荐，就会使得推荐结果的候选集永远只在一个比较小的范围内，所以在保证推荐结果相对准确的前提下，应按照一定的策略，去逐渐拓宽推荐结果的范围，给予推荐结果一定的多样性。

对应商品评论的处理主要有以下几点：
* 商品评论筛选。过滤恶意差评，对关键字筛选（脏话、广告等），对出现敏感词汇的评论直接过滤或人工审核。
* 分级显示商品评论（好评、中评、差评），统计商品好评度，并提炼评论中的关键词（如手机评论中的“外观漂亮”、“系统流畅”、“屏幕大”，或者有图等）。
* 根据商品评论和服务评论对商家店铺进行评级。需要制定严格的规则，避免商家刷信誉或者用户恶意差评影响店铺级别。


# 第4章 促销系统
促销活动有很多现实价值：
* 拉新；
* 去库存；
* 扩大品牌知名度；
* 推新品爆品；
* 与其他平台竞争。现在有许多人造购物节，例如双11、618，许多电商平台或商家，主动或被动都要参加促销活动；
* 提高客单价、客单量。在优惠券、满减满赠等活动的催化下，用户不自主地都会去凑单购买，增加购买金额，同时产生许多额外的购买行为；

在活动结束后，进行活动复盘，一是针对各渠道的投入进行分析，合理改善活动开支，二是要对整体活动的价值进行分析，判断投入产出比是否健康。

如果活动周期较长，在活动期间可以进行“A/B  Test”，在不同时间里或不同渠道中执行不同的促销手段，通过对比查看最优的促销方式，在其后的活动中，调整最优的手段来进行促销。

促销活动是一把双刃剑，国内的电商行业已经陷入了不断促销的怪圈，大量促销也严重拖累了毛利率和利润表现。频繁促销也扰乱了品牌定位，对品牌定价造成无法预估的风险。对用户来讲，也催生了许多无用消费。

目前电商系统能够支持的促销形式大致总有7 种：满减促销、单品促销、套装促销、赠品促销、满赠促销、多买优惠促销、定金促销。

特别提一下“定金促销”的形式在2016年双11开始广泛应用，对电商供应链的备货和物流控制大有益处。

满减促销：购物者只要购买相应商品到规定价格即可得到一定的减价优惠。主要有两种形式：阶梯满减和每满减。阶梯满减，例如满100减10、满300减50、满500减80等；每满减，指订单金额每满规定金额就减免一定金额，比如设置每满100减10，那么订单金额230元就实付210元。

单品促销：在特定时间内购买指定商品享受一定的价格优惠。例如促销期间商品6折，那么原价100元的商品，购买时就60元。

套装促销：商品组合套装以优惠价出售。例如A商品50元，B商品80元，而A和B两种商品的套装促销价100元。

赠品促销：购买主商品之后赠送商品（可多个赠品）。

满赠促销：购买商品金额满X元后送某商品，或者购买商品金额满X元后再加价Y元送某商品。这种形式与赠品促销的区别在于该形式以相应商品订单的价格来区分，可分阶设置，例如满300元送自拍杆，满500送充电宝，满1000送高端耳机等。

多买优惠促销：有“M元任选N件”、“M件N折”两种优惠形式。这个主要是参考一些线下卖场发展的促销形式。

定金促销：在商品正式售卖之前采用预付定金的促销模式，提前交定金可享受优惠价。定金促销有多种玩法：定金预购，相当于交定金就已经确认订单；定金杠杆，交一定金额的定金可以在正式购买时抵更多金额，比如交定金10元未来可抵30元。

对于不同类型的优惠券，实际运营中有许多种玩法。商家一般主动向用户群发优惠券，并适度提醒，来促进用户消费。

拼团是拉新、引流的利器，特别是在移动社交的环境下。拼团模式就是在微信中逐步成长起来的，最典型的就是拼多多。通过开团、参团、分享的模式在社交圈中快速传播，而且利用熟人关系链间订单转化率高，可以迅速拉新，特别是群聚效应下可快速成团。

促销编码：系统自动生成，相当于活动的唯一码。

推广链接：在建立活动后，应生成专属活动、专题页面，自动生成活动链接。活动页面配置可与活动设置分开。

定金促销的方式和其他促销方式区别很大。首先在库存上，参与定金预售的商品时单独分配活动库存，不会占用总库存，待商品到位后才会正式扣减真实库存，再往下流转至仓库；其次在订单上，定金杠杆这种类型将订单的支付确认分成了两步，从定金到尾款，在商品正式售卖时，应提醒用户继续支付，完成订单支付。

复制活动这一个功能，将某一活动内容直接复制平移。新建的活动只需要在原基础上修改就行。

涉及促销商品计算的主要有两个地方：购物车和订单计算。首先判断选中商品是否参与促销活动；其次再判断是否满足促销条件，根据促销规则计算出订单金额；最后还要判断是否可与其他优惠同时享用，比如大部分优惠是不支持与优惠券共用的。

在商品参与多种促销活动时，如果发生冲突，一般是按照最优原则，自动选择最佳优惠方案计算。

还要判断当前所选商品是否参与其他促销活动，是否与当前活动有冲突。例如A商品参加4月的活动，满400元减20元，如果再次设置该商品参加满400减50的活动，就与该商品已参加的活动冲突，所以不可设置。

在购物车中，除了可以展示促销信息（满赠、满减、套装、换购）的作用，还可以让用户在多优惠并存而只能选其一的情况下，选择修改促销方案。

优惠券有多种分类方式，按照使用门槛、使用范围、发放主体等有不同的分类。

按照使用门槛分为现金券、满减券、折扣券。

按照适用范围分为：单品券、品类券、品牌券。

按照发放的主体分为平台优惠券和店铺优惠券。平台优惠券：优惠券由平台发放，可以跨店使用。比如平台活动优惠券、平台注册的新人优惠券、平台积分兑换的优惠券。

平台优惠券的成本由平台和店铺共同承担，在店铺使用时优惠金额由平台返给店铺；店铺优惠券的成本则由店铺自己承担。

优惠券有主动领取和被动领取两种方式。

系统发放优惠券的场景有很多种：比如用户注册、大促活动、客服发券——主要是售后补偿（平台责任导致售后，发券补偿客户），以及好评返现。

许多平台电商还有一项业务：大客户团购，主要是给一些特定单位提供的福利卡，本质上也相当于给用户发优惠券，例如京东卡。

用户输入卡密兑换之后，兑换成平台的交易币（相当于给购物卡充值），可以用来抵扣订单金额。

优惠券的前端露出窗口主要有五处：用户优惠券列表、订单提交页、购物车、商品详情页、领券中心（或优惠券分享链接）。

在订单完成售后（退款或退货）时，优惠券应有一定的返还机制。有以下多种情况。
* 统一设置成不可返还，用了之后就不退。
* 订单中全部退款时，优惠券全部退还。
* 订单中部分退款时，普通优惠券不返还。

提一个目前绝大部分产品难以解决的问题，供大家思考：基于日常优惠券的使用情况，运营人员如何平衡发放优惠券所带来的成本增长、商品销量增长和单品毛利下降之间的矛盾？在申请促销活动经费时，怎样的数据更具说服力？

拼团模式的应用场景主要有两种。一类是专门做拼团模式的电商，如拼多多、萌店等，前期通过一些优质低价的拼团在外部社交网络中分享，大量积累客户，后期主要以特卖电商的形式在站内运营，注重订单量，具体表现为前期多是10人团、20人团等多人团，后期多是2人团、5 人团，并且可以站内参团。另一类就是普通电商平台，拼团主要是为了拉新、打造爆款用，适合中小型电商公司。类似淘宝、天猫、京东等大型电商平台很少做拼团，主要是秒杀限时抢购。

拼团主要有几种类型：新人团、普通团、超级团。

新人团主要限定新用户（未下过单）参加，可以由老用户开团，这一类型的团购主要是为了拉新。在参团时要校验是否新用户。

普通团就是最常见的拼团团购，例如2人团、5人团等，任意用户都可以参加。

超级团是指需要较多的人参与才能成团，根据成团人数来制定阶梯价格，一般为50～200人团。例如商品A原价100元，50人团则售价80元，100人团则售价70元，200人团则售价60元。在有效时间内达到规定的参团人数，就组团成功，人数不足自动退款。

一般采用付款成功才能参团成功的流程。先成团后付款的流程，由于打断了用户整体操作流程，影响用户体验，很容易导致用户更多放弃支付。

在支付时再次去判断是否满团，是为了避免“超团”，比如原定是2人团，结果最后有3人参团成功。

拼团成功或拼团失败，都要以一定的方式（短信或APP提醒）通知用户。

拼团在前端产品设计上，主要是展示时间紧迫性和易于分享参团。通过倒计时等方式提醒用户时间紧迫，让用户急于主动分享，主动为产品开辟渠道引流量。另外也要提供简单易用的分享功能。增加等候成团区，用户可以直接在商品详情页参加别人的团，这种方式实质上是为了增加订单量。

拼团商品的库存直接从总库存划分一部分库存参与活动（占用），在活动期间，拼团商品的库存和正常售卖的库存互不影响。拼团结束之后将剩余库存返还给总库存，解除占用。

关于拼团库存扣减，有如下两种方案：
* 参团支付之后扣减库存
这种方案会占用实际库存，未成团的那部分库存就无法出货，造成浪费。恰A悀例如：A商品有100件，参加10人团，最初开团20个。最终100人参团成功，但是只有5个团成功拼团，所以发货50件，其他50人退款。
* 拼团成功之后再扣减库存
这种方案无法管控成团数量，库存用完之后，后续拼团成功的就会超卖，发生退款，影响用户体验。可以改进的是，在拼团支付的时候，要判断当前是否有剩余库存（用总库存减去已成团数量），若判断没有剩余库存，则不允许参团或开团，也不允许支付。旰A悀例如：A商品有100件，参加10人团，最初开团30个。最终200人参团成功，前10个团成功拼团，发货100件，其余100人退款。旰A悀两种库存扣减方案都是可行的，但都有一定的缺陷，大部分电商采用的是第二种方案，这样更多是为了拉新，或让更多用户参与。为了避免超卖，可预留一小部分库存，来应对超出的情况。


# 第5章　内容管理
在网上购物时，这种活动页面很常见，商城或店铺首页也会不断变化风格。实现的方式是“快速自定义页面”，其也常被称为“店铺装修”或“页面配置”。

电商公司都会有各种运营页面需求，如果每个页面仅靠前端技术人员单独制作，会占用大量的人力物力。同样的活动元素、页面，也许就是调下元素顺序，换几张主题图和链接，这次的活动资源下次可以接着用。持续需要开发介入，无效重复劳动是件很头疼的事，而且频繁发布对用户体验也会造成较大影响。这时候就产生了页面动态配置的需求，也就是淘宝店主经常做的“装修”，在丰富的配置组件下，运营人员根据业务需求来自定义活动页面。

首页设置、活动页面配置、自定义新页面等都属于此类范畴。

“淘宝旺铺”就是店铺装修发展出来的一门生意。

商品详情页的某些内容虽然不能更改，但可以往里添加推荐内容，例如活动推广、商品推荐等内容，最大化利用页面空间，给运营提供便利性。

基础组件的定义和解析是自定义页面的核心，不同的组件有不同的功能，表示不同类型的内容。每个组件都需要单独设计，定义其规则和样式。

图片组件中几个最基本的样式：单图、双图、轮播图，以及多图。每种样式的图片在系统中都对应规定不同的尺寸，上传图片需要按照要求的尺寸上传。

跳往结果页主要有自定义链接、自定义活动页、商品分类、店铺、商品详情页、优惠券、购物车、会员中心等。

商品也是很常见的组件，有纯粹的商品显示，还有直接在活动页加入购物车。几种常用的样式：单列商品、双列商品、多商品等。

可以提供自定义页面的复制功能，从已有的自定义页面中复制出新页面。由于同一家公司的运营风格在短时间内不会发生太大变化，每次活动页的形式其实都差不多，提供这个功能，可以减少运营的工作量，运营人员只要在旧页面上替换相应的内容就可以二次使用。


# 第6章　库存管理
对于库存管理来说，最重要的是库存的分配与扣减逻辑。

电商库存体系分为三层：销售层、调度层、仓库层。

库存的变动又分为自上而下、自下而上两种。

每一层库存数量的变化可总结为增加、锁定、解锁、扣减、返还等。

库存数据的变动都需要有相关单据依据，例如销售订单、发货单、采购入库单等。

库存系统的操作主要包含库存的增加、锁定、解锁、扣减、返还、异常处理。

锁定：下单之后锁定库存。

解锁：订单取消之后释放锁定库存。

扣减：订单支付成功之后扣减库存，扣减锁定库存。

返还：退货、换货后返还库存，相当于增加库存。

异常处理：库存数据在定期校验时，如果出现异常数据，就需要进行异常处理（自动或人工处理）。

意库存变动的影响因素，主要有销售订单、采购、仓间调拨、盘盈盘亏、预售、售后退货等因素。

将库存管理体系分层为销售层、调度层、仓库层，主要是因为各层的职能不同，驱动库存发生变化的单据也不一样。

一般情况下，前端库存要和实物库存保持一致，即不能超卖。但是做预售时，就是虚拟库存，下单时涉及的库存动作只在销售层，待到备货之后，再推送至调度层。

销售层的库存决定是否可售卖，下单是否能成功。在秒杀时，活动库存决定了是否可以秒杀成功；在预售时，预售库存决定是否可下定金预定。

调度层相当于订单的分配中心，将订单转化为发货单，按照调度规则决定哪些SKU由哪个仓库发货。

调度层的库存分为单仓、区域、总库存三个维度，区域库存指的是这些仓库只发某一区域的，例如华中地区的仓库只配送华中地区，北京就无法从华中地区的仓库发货。总库存即所有仓库的SKU库存总计。

账面库存：仓库中的实物库存，只要是未出库的都算在账面库存中。

可用库存：仓库中可供发货的库存。这部分库存是可供调度的库存。

在途库存：下了采购单但是尚未入库的库存，在途库存理论上部分是可供销售的，例如“T＋1”的在途库存，就是指1日之后就可以入库的SKU。

不可销售库存：仓库盘损的库存，通常是仓库中的不良品，是无法售卖的库存。这部分库存需要通过特定途径处理。

已用库存：在调度层已分配的库存。

仓库层的库存对应的是实物库存，出库入库盘点都会引起仓库库存的变动。

可用库存：发货单推至仓库后，仓库可以用于发货的库存，不包括锁定的库存。

锁定库存：发货单推送至仓库后锁定库存，锁定时同时去锁定库位库存。

已出库库存：已经确认出库的实物库存。

不可用库存：盘点时发现的不良品，需要报损，从可用库存转化为不可用库存。

库位的概念。仓库中的库存是由库位库存组成的，库位上分为可用库存、锁定库存两种。由于WMS中的库存逻辑较为复杂，这里不做详细论述。

库存的变动有两种流向。第一种是自上而下（从销售层到调度层，再到仓库层）；第二种是自下而上（从仓库层到调度层，再到销售层）两种。

自上而下：用户下单后，首先会生成订单，扣减销售层的库存；然后流转到调度层进行调度，生成发货通知单，调整调度层的库存；最后推送至仓库，WMS系统同步响应，扣减库存并进行出库。

自下而上：仓库的实物入库可以算是从下到上引起的库存变动。主要有三种单据：采购入库单、退货入库单、调拨入库单。实物入库，会连锁引起仓库层、调度层、销售层的可用库存逐步增加。

一般情况下，销售层的库存要和调度层的实物库存保持一致。但是有时候业务需求是允许超卖、做预售、不同活动独占库存、不同渠道分配库存，就会造成预售层库存与调度层实物库存不一致。

* 允许超卖。这种场景很常见，在双11、618这些活动时，在备货量不足的时候，为了订单量往往会允许超卖，只要及时补货就行。

* 做预售。例如苹果、小米新品发布时经常玩的套路：先交钱，预估出货时间，等有货了再给买家发货。

* 不同活动独占库存。拼团、限时秒杀这类促销活动，往往是从实际库存取出部分库存来做活动。例如正常价值199元的背包，库存1000件，现在拿出100件做活动，99元限时秒杀。

* 不同渠道分配库存。许多商家有多个渠道，通常有自营平台、天猫店、京东店、有赞店等，这些平台都共用一套库存。在对接各平台之后，可以把对不同渠道分配库存。

现货库存是同步调度层的实物库存。

可销售库存＝销售总库存-锁定库存

预售库存是虚拟库存，无实物，到货之后才能发货。这种类型的需求可以通过销售总库存与实物库存断开同步、单独设置的方式来实现。嘰A悀前台买家下单成功之后，店家等实物到货之后，统一推送至仓库，安排发货。

许多小卖家都是一个仓库或者一物一仓（一个SKU只在一个仓库有货），这种情形下，库存调度逻辑很简单，扣减相应仓库的SKU的库存，调度到对应仓库进行发货就行。

调度仓库的过程实际上是在各种调度规则的限制下，对库存进行调度。

有些企业在业务量较大时，会在同一区域内除了建立中心仓，还会建立多个区域仓，例如华东区（上海、浙江、江苏）中心仓在上海，在杭州、宁波、苏州、南京等订单量较大的城市建立区域仓。这些区域仓库存量较小，存放一些消费频次高的SKU，只供应当地城市。在区域仓没货的时候，才会从中心仓发货。

在仓库多了（假设全国100个仓库）之后，在前端商品判断有货没货及物流时效时，如果按照优先级排序及调度规则，一个个仓库去遍历判断，会影响效率。这种情况下，在销售层会按照区域库存去判断。例如将华东地区的12个仓库中SKU库存合并，如果是宁波地区的用户购物，只需要判断华东区域的库存。当订单下发到调度层时，再具体去分配仓库，如有必要再进行拆单。
```
只需要判断父节点
```


在业务发展时，会有部分货源从供应商处直接发出，或者为了保证物流时效，在某些区域由供应商直发，这种仓库定义为供应商协同仓。椠A悀再对这些SKU库存进行调度时，就需要在调度层直接把仓库下发给供应商订单系统。

产品要跟着业务走，调度逻辑随着业务复杂度、销售渠道、仓库数量等因素的变化而增加难度。

同一仓库不同级别区域不能重复。

企业在不同区域都有中心仓、协同仓。不同类型仓库优先级不同。

同一仓库配送区域分级，分一级区域（24小时达）、二级区域（2日达）、三级区域（2日以上）（可根据物流时效设置）。同一仓库不同级别区域不能重复，对于同一仓库，配送区域等级不能重复。

同一省份的供应服务商，设置其配送优先级。

物流时效优先。

库存调度示例逻辑如下：
* （1）在下单时，先筛选出对应订单有库存的仓库。
* （2）将收货地址与这些仓库的一级配送区域匹配，若没有再去匹配二级区域，依次类推。
* （3）筛选出同级区域（物流时效相同）的仓库，再根据仓库的优先级进行筛选。
* （4）若仍有多个仓库（同一类型的仓库）待选，例如金华从宁波协同仓、杭州协同仓发货时效相同，再根据同级仓库之间的优先级来进行选择，最后选择仓库（例如杭州仓）。
* （5）选择好仓库之后，再根据SKU优先级、运费（体积、重量）等因素来选择物流公司。后面章节会具体讲到。
* （6）当订单中有多SKU时，还会根据库存调度规则进行拆单，本节不做细讲。

没有最好的产品方案，只有最合适的方案。库存调度的过程实际上是订单分配的过程，受许多因素影响，和许多系统发生交互。

库存控制的任务是用最少的费用在适宜的时间和适宜的地点获取适当产品。库存是包含经济价值的物质资产，购置和储存都会产生费用。尰A悀库存系统的成本主要有购入成本、订货费、储存费用及缺货成本。


要做好库存控制，首先要思考以下几个问题。
* （1）如何优化库存成本？
* （2）怎样避免浪费，避免不必要的库存？
* （3）怎样避免缺货损失和利润损失？

而要解决这些问题，主要把注意力集中在以下三点。
* （1）需求预测
* （2）安全库存
* （3）库存控制模型

需求有五个方面的因素必须要考虑，即数量、时间、频率、范围以及可预测性。

数量是可以用精确的数字来表达，也可以为一个范围或一个概率，例如判断某种商品95％的需求位于80到120件之间。

时间是指预测的时间跨度。预测按时间的不同可划分为：短期预测、中期预测和长期预测三种。

短期预测的方法一般包括简单平均、加权平均和指数拟合等。短期预测时间跨度最多为1年，而通常不少于3个月。

中期预测的方法包括曲线和指数平滑、基数序列等。中期预测的时间跨度为2年左右。

长期预测的方法一般包括简单回归等。长期预测的时间跨度通常为2年及2年以上。

频率是特定时间内满足需求的次数（一次或几次）。

范围是指需求数量的变化范围。

可预测性：需求或消耗可能会与历史数据相同，也可能与历史数据有联系，也可能与历史数据毫无关系。考察历史消耗量与补充库存数据可以揭示未来的形式及趋势。这些形式及趋势可能是随机的或无序的、周期性的或非周期性的。

时间序列分析方法力求以历史数据为基础来预测未来。例如由过去六星期中每个星期的库存需求量可以预测第七个星期的库存需求量；由过去几年内每季度的库存需求量可以预测未来各季度的库存需求量。

将独立需求的商品的库存分为周转库存和安全库存两部分。周转库存是指保证在固定周期内正常供应的库存量，订货量可以由各种经济订货量模型确定。

在低于安全库存时进行预警，开始补货动作。

库存控制要解决的问题有以下几个。
* （1）多长时间检查一次库存量？（订货间隔期问题。）
* （2）何时提出补充订货？（订货点问题。）
* （3）每次订货是多少？（订货批量问题。）

两种基本的库存模型，即定量订货模型（也称Q模型）和定期订货模型（也称固定订货间隔期系统或P模型）。

定期订货模型按照预先确定的时间间隔，周期性地检查库存，随后发出订货，将库存补充到目标水平。

电商一般采用的是定量订货模型。

定量订货模型与定期订货模型的基本区别是：定量订货模型是“事件驱动”，而定期订货模型是“时间驱动”。定量订货模型在达到规定的再订货水平后，就进行订货，主要取决于对物资的需求情况，订货时间可能随时发生。定期订货模型只限于在预定时期期末进行订货，是由时间驱动。

库存管理不是简单的需求预测与补给，而是要通过库存管理获得用户服务与利润的优化。目前绝大部分电商企业的库存控制还处于很原始的阶段，远不及传统销售生产企业对库存管理的控制。库存控制涉及多部门协作、多系统交互，而且电商销售不同于传统零售业，传统的库存相关模型也不一定同样适用于电商企业。从供应链上下游协同出发，运用拉动和推动结合的供应链，来更好地实现降低库存、提高服务水平、快速响应用户需求的总体目标。


# 第7章　物流管理
电商目前提供的物流服务主要有三种：普通快递、同城配送、门店自提。

可以预见的是，门店自提将会是”新零售时代”的重要物流方案。

同城配送服务不仅在配送速度上有保证，还能改善最后一公里的服务。

随着新零售模式的逐步开展，门店自提的方式会越来越普遍。

电商在收取运费时会考虑将商品利润拿出来补贴用户运费，所以经常有包邮、满X元免运费、运费一口价等运费方案，或根据距离、重量收取。

实际运费和向顾客收取的运费有所区别。在各地有多个仓库的自营电商，每个仓库和当地物流服务商都会谈判确定一个服务价格，不同物流公司在同一地区的报价也会不同，所以调度系统在选择出货仓库时，除了要考虑库存、发货距离、配送时效，还要考虑物流成本。这就需要后台录入和仓库对应的各物流公司的物流成本，变量有收发货地区、价格（首重、续重），或某些特殊品类的物流成本。更智能的做法是，通过计算各物流公司的实际配送数据，动态去调整物流公司选择的各参数（时效、成本、距离等）的权重。

前端运费是通过运费模板来判断的。

运费模板的应用模式有几种类型，包括店铺运费模板、单品运费模板，以及混合模板。

店铺运费模式：整个店铺采用统一的运费标准，可设置收取固定费用，支持不同区域设置不同的运费标准。例如收取固定运费10元；或者满X元包邮，不足X元统一收取10元。

单品运费模式：为店铺内的每个商品设置单独运费，每个商品的运费独立计算，当一个订单包含多个不同商品时，可以选择“运费叠加”或“取最大运费值”两种运费计算方法之一。

混合模式（店铺运费与单品运费同时生效模式）：店铺运费模板与单品运费模板同时生效，店铺运费优先判断。

当订单金额满足运费上设置的免邮金额，按照店铺运费模式计算，不满足时，按照单品运费计算。

如果单品运费模版上设置了单品运费优先店铺运费，单品运费模版绑定的商品的运费单独计算，即使订单金额满足店铺免邮，也会按照单品运费模版计算运费。

在实际的物流管理中，除了物流公司管理、配送区域、资费等主要功能模块，还有地区物流公司管理、重量体积限制等细节。

由于大小件的不同运费，对于快递公司与大件物流公司要区分管理，对于大部分商品主要从快递公司中筛选，对于特殊品类的大件商品主要从物流公司中筛选。

商品的实际运费远比前端运费要复杂。如果一个电商企业在各地有多个仓库，就需要针对每个仓库中的每个物流公司维护一套运费计算规则。

有人会问，全国的仓库为什么不选择相同的物流公司进行服务？原因主要是物流公司在不同区域的服务水平不同，收费标准不一样。有些物流公司是加盟制，区域物流商的话语权很大。另外某些物流商在区域服务很好（例如只在珠三角区域服务），价格还很低，从性价比的角度来选择也很正常。

同一仓库的同一物流公司还会因为品类不同有不同的运费模板，可能存在不同的协议价。另外还需要对每个物流公司设置配送区域，选择优先级。

对于某仓库的某一物流公司，有些特殊品类的商品运费结算可能不同，有的计重（比如日常生活用品），有的按照体积（比如箱装轻质商品），有的计件（和地方物流商议价，比如轮胎一条运费5元）。

同一运费模板，可能针对不同目的地区又存在区别。例如最常见的运费模板——计重，北京仓发往华北区域首重5元（3kg内）、续重2元（每增加1kg）；发往华东、华南等区域首重8元，续重3元；发往西藏、新疆区域首重10元，续重5元。

系统按照规则提供了最优的物流选择结果，客服也可以按照客户要求来进行修改。

物流状态的链接是通过物流单号，货物的追踪也靠物流单号。成熟的电商企业在订单推送至WMS（仓库管理系统）后，就为订单锁定了物流单号，出库后将物流信息传送给物流公司，通知其揽件。


目前常见的物流单号来源于如下几种：
* 从菜鸟接口获取。获取时需传输收件和发件信息，菜鸟接口反馈物流单号。主要是阿里平台（淘宝、天猫），系统会自动获取物流状态。
* 预先从物流公司购买号段，导入系统，使用时直接获取。物流状态通过单号去快递100查询，保存在数据库中。
* 自营物流，自己生产物流单号，更新物流状态。

在管理物流单号时，应及时将单号从“未使用”状态变更为“已使用”，而当中途取消出库后，还要回收单号。一般WMS中都有打印物流单（按照固定模板）的功能，物流公司只需要扫描识别信息即可，不用物流公司另外打单。

通过各类物流查询接口，实时获取订单的配送情况，还可以定期把这些数据格式化后化存储在系统中，后续可以根据这些对快递进行KPI 考核。有了订单的详细配送情况信息，就可以对快递公司的各项KPI指标进行低成本的量化。

物流管控是电商企业的基本竞争力。


# 第8章　采购管理
采购管理系统是根据企业对商品的需求，确定何时采购、向谁采购、以什么价格采购，以及何时收货等采购事务。

电商的供应商不同于生产企业，不但有传统的商品供应商，还有虚拟商品供应商、代发、代销等多类型的供应商，在采购执行策略上也有区别。

采购系统的核心在于采购单。

采购人员根据业务部门的需求或者系统预警，新建相应的采购申请单。

采购管理人员对采购申请单进行审核。

采购系统生成采购单之后，将相应采购信息（供应商、SKU 信息和数量、入库仓库、预计到货时间等）传给调度中心，由调度中心生成采购入库单下发给仓库。

仓库管理系统（WMS）生成采购入库任务，当实物验货完成之后，返回入库信息给调度中心，调度中心再将入库信息通知采购系统，更新相关信息及状态。同时调度中心去库存中心更新相关商品的库存。

当采购单的实物全部入库后，财务系统根据采购到货情况，与供应商进行结算。

结算完成之后，采购单才算结束，整个采购流程才算走完。

采购单有分批到货或者只到部分货的可能性，例如采购了1000件A商品，分三次（比如每批次件数依次是300、500、200）到货，可能到了800件，供应商就没货了，这就需要允许采购单分批到货，直接终止。

进行库存控制的主要目的是提供采购建议。

采购提前期：从发出采购订单到订单收货所要经历的时间。

由于电商系统不同于生产企业，在商品需求预测上往往不太精准，更多需求可能和营销活动、时令需求相关，只有少数大型电商企业或垂直电商的商品需求会保持稳定，可准确预估。

常见的采购模式有以下两种：
* 自采自卖：平台从供应商那里采购商品，入库到自己的仓库进行售卖，这些商品的所有权属于平台。这是目前大部分电商采用的模式。
* 一件代发：主要指商品平台销售出去之后，由供应商代发，按订单结算商品和物流费用，这种模式兴起于淘宝平台，很多小卖家无力自备库存，而选择该模式还能减少库存资金占用。该模式的缺点是对货源掌控力度差，销售末端服务较差。

“多货主仓库模式”，平台将仓库开放给供应商使用，当供应商的商品入库时，它的商品所有权属于供应商。对于平台和供应商来说，独占、锁定、共享库存这几种形态都可以存在。当平台向供应商发起采购后，将相应商品的货主进行变更就行。怰A悀库存共享时，当顾客订单下发至仓库时，向供应商发起采购订单，快速处理之后，从供应商库位拣选相关商品，变更商品货主，后面按照采购订单，定期与供应商结算就行。

随着京东、顺丰、菜鸟逐步开放仓储能力，这种模式会越来越常见，并且成为未来的主流模式。

采购流程中首先维护的就是供应商资料。

经营资质：有些品类需要进行资质审查，比如酒类、医药等商品，在合规的基础上进行采购。

采购合同：采购行为的成立要依靠合同来证明。在企业采购中，最主要的合同有三种类型，首先是确立两家公司合作关系的合同，阐述合作关系、供应商品类等商务条款；第二份是商品协议价合同，与供应商确定所供商品的协议价，这是每次采购的基础参考价，定期更新（半年或一年）；第三份是单次采购单的采购合同。采购单中的商品采购价格不一定是协议价，会根据采购量和市场价格进行调整，或者直接按照协议价执行。

商品的采购成本都是按照采购合同动态变动，在财务核算时要将动态采购成本核算进去，最准确的是仓库按照批次管理商品，进行出入库。

商品的采购成本在动态变动，影响因素有很多，如供应商、市场行情、采购量等。同一SKU通常有多个供应商可以供货，甚至有的供应商只能在部分地区供货。

在生成采购单时，首先选择入库仓库和供应商，再添加相应的SKU 明细（数量、单价）、预计到货时间，以及财务信息（发票类型、支付方式、付款周期、预付款等）。采购单价可能直接是协议价，也可能经双方再次确定。协议价是在供应商管理中维护，相应的付款方式也是在签订合作时确定。

采购发票在公司财务结构中非常重要，可以用于抵税、凭证等多种用途，所以对于采购发票的进度跟踪、管理就至关重要。

发票是与采购单绑定的，当采购入库、完成结算之后，由供应商开给企业。


# 第9章　仓库管理系统
WMS属于电商后台系统的服务末端，相对独立，也是实物管理与系统完美结合的应用。通过WMS 实时同步仓储货物的变化，确保物料先进先出，与采购系统、订单调度系统同步更新库存，管理仓库工作人员的工作流。

仓库布局是一门很深的学问，而且要随着业务逐步优化，一般仓库分为分拣区、存储区、不良品存储区、发货暂存区、收货暂存区、复核区、仓储器械存放区域等部分。

复核区：员工拣货之后将商品推送至复核区，复核员按照发货单去检查商品是否正确拣选。

分拣区：分拣区类似超市的货架，存放商品供拣选。分拣员按照发货单及系统指引在分拣区的相应库位上拣选商品到拣货车上。分拣区按照货品分类来划分很多块，例如A区存放食品，B区存放家居日常用品等。一般有平面区和立体区，立体区是指货架有多层。

存储区：类似超市的仓库，存放大批量的货品，当分拣区不够的时候，从存储区进行补货。货物入库之后一般会先进存储区。当业务量较少或动销率较高时，就没有存储区，直接上架至分拣区。

区域划分的同时也意味着人员分工，仓库员工在不同区域间流动，负责打单、拣货、复核、交接、盘点、收货、上架等不同的工作。

在仓库中使用条形码对货品信息、批次、库位等进行管理，提高各环节的作业效率与信息化程度。

当发货单推送至仓库后，就进入了仓库的任务处理队列中，经历调度、打单、拣货、复核、包装、交接发货等一系列过程，最后交接给物流公司。

订单调度中心将发货单（包含SKU信息、收货信息、物流公司等）推送至仓库之后，在WMS中生成新的仓库订单，系统开始预调度仓库订单，锁定库位库存。同时为订单分配物流单号。

锁定库存的原则是先进先出，不是随机锁定的。上架商品时也是在指定库区中由近及远，先上架最近的库位。上架和下架选择库位规则的统一保证了先进先出的可能性。

如果在预调度时，拣货区库存不足，就生成相应的补货需求。

在预调度之后，生成拣货波次。拣货波次是指将几个订单合并拣货，可以提高拣货效率。

生成拣货波次可按照预设规则自动生成，亦可人工筛选订单生成拣货波次。

打单是指将波次对应的物流单和发货单打印出来，以便拣货、复核以及交接发货。发货单放在包裹内，主要是发货单详情。物流单贴在包裹上，类似快递面单。

拣货路径的算法在拣货时也至关重要，主要是缩短拣货员的拣货距离。

应尽量避免让拣货员去思考。

分拣，意味着有拣有分，同一个波次的订单会合并拣货，而放在货位上时会分开。

复核主要是对拣货完成的订单进行核对，保证发货单、实物商品、物流单的统一。扫描发货单上的仓库单号条码，定位到相应的订单，再去扫描商品条码，保证商品和数量无误，最后扫描物流单，校验发货单、实物商品、物流单三者完全一致时，视为复核完成。

在WMS系统中，出库是信息流与实物流的结合，应使用条码技术和PDA来指导仓库员工的操作。最大的难点主要是库存管理和拣货路径。

商品入库主要是依据采购单，偶尔也会依据退/换货入库单、调拨入库单等。

入库单推送至仓库之后，在WMS中生成入库任务，当相应商品到仓库之后，选中对应的入库任务进行确认，生成相应的验货任务。同时打印相应的入库验货单（采购单、退货单等）。

当仓库收到入库单时，相应的货物不会立马到仓库，确认到货的步骤可以阻拦验货的任务池的纯净。

同一个入库任务允许到货多次，这在实际场景中很常见。

由于采购只收合格品，不良品数量并不被录入到系统中，而是直接退给供应商。验货时，到货数量小于应到数量时，将剩余的未到货任务再次返回到货确认任务池中，等待下次到货。退货单将合格品和不良品都录入到系统中。不良品会上架至不良品库区。

当验货完成之后，通过WMS系统打印相应数量的商品条码，由仓库员工进行贴码。

在电商系统中，每个商品都有SKU码在系统内部流通。现实中每个商品包装上有自己的条形码（69码）或者直接没有条码（例如水果生鲜等）。

商品上架不仅包括商品入库上架，还包括补货上架、移库上架、返库上架等情形。

盘点，是指定期或临时对库存商品的实际数量进行清查、清点的作业，对仓库现有商品的实际数量与保管账上记录的数量相核对，以便准确地掌握库存数量。

盘点的类型分为动盘、抽盘、全盘三种。现在盘点基本是在仓库不停产的情况下进行的，也就是边拣货边盘点。通过PDA直接取实时库存进行盘点。

动盘：选取从库位上次盘点之后，截止到目前库存发生变动的所有库位生成盘点单。

抽盘：选取一定条件（库区、库位、商品条码）的库位商品生成盘点单。

全盘：选取整个仓库生成一个盘点单。全盘工作量较大，频次较低，一般按季度或者全年的周期进行。

在拣货时需要用波次绑定拣货车，当复核完成之后再释放。

移库操作，允许人工将某一库位上的商品转移到其他库位上。

在电商支撑系统中，WMS可能是唯一需要软硬件结合的系统，需要与多种硬件（PDA、打印机、AGV、传送带、打包机等）结合，以文字、图形、语音、信号灯等多种方式传达信息。


# 第10章 订单管理
在订单过程中进行安全校验，主要是检测用户是否在黑名单上、用户购买行为是否正常等，当检测到不正常时，终止下单。

父订单与子订单：当从购物车选中多件商品时，例如选中三个店铺中的商品，会将这次购买行为拆分成三个店铺的订单。这次整体的购买行为记录在父订单下，当系统首次提交订单结算时，会合并子订单，针对父订单进行结算。当提交订单后结算中断，或结算之后，系统在更新订单状态、物流追踪时，针对的就是子订单。

优惠后订单发生部分退货如何处理。

其中涉及用户与平台之间的博弈，也考验着产品规则设计者的智慧。目前的处理规则基本都是“优惠分摊，偏向用户”。

假设双11时，用户分别在A和B店铺跨店买了参加满1000减200活动，各买了500元的货品，后来在A店退了价值100元的东西。这种情况下，退货后已不满足活动条件，是否要求用户给补100元？如果用户补款，又补给谁？

从上面的例子可以看出，如果将退货没达到条件的促销优惠条件考虑进去，系统复杂度会成倍增加。从人性的角度，我们相信绝大部分用户不会为了达到优惠条件故意多买，然后恶意退货。

最合适的处理方法就是下单时就将优惠金额按比例分摊到子订单、商品上，同样实付金额也分摊到子订单、商品上。退货时退还用户实付金额，而不会去追究用户因退单而没满足促销条件，允许用户占平台的便宜。

关于优惠分摊原则，不但应该按比例分摊，还应在满足优惠条件的商品上，按照商品金额的比例分摊，而不是盲目分摊。

在实际应用中又会衍生出许多变化。例如支付服务：有第三方支付、分期付款、货到付款等，都影响订单的状态。

订单拆单在电商订单中很常见，也比较复杂。拆单也有两次，一次是在用户提交订单之后、支付之前拆单，这次是拆分的订单；另一次是在用户下单之后，商家发货之前，去拆分发货单（SKU层面）。

若是跨境商品平台，则需要在支付前完成所有拆单步骤，因为报关需要三单对碰，订单、支付单、运单与进口清单一致。

拆单，顾名思义就是客户在下单时，为了发货和结算方便，后台需要对订单进行拆分。

由于商品归属权不同，涉及财务结算和发货的问题。店铺商家不同，需要拆分订单。例如京东自营和平台各商家的商品在下单时会拆分成不同的子订单，因为售后入口不同；不同淘宝、天猫店同时下单会按照店铺进行拆单。

由于发货仓库不同，按照商品归属的仓库进行拆单，若有多仓有货，还应按照地域时效选择仓库进行拆单。

由于商品属性和价值的不同，同样会产生拆单需求。无A悀例如易碎品需要特殊包装，超大物品（儿童座椅、轮胎）需要单独包装。甚至有些品类不同的商品不能放在一起，都需要按不同情况来定义拆单规则。

不同物流公司对单个包裹的重量或体积都有特殊要求，需要根据SKU的毛重和体积计算包裹总重量和体积，超出物流公司限制的也需要拆单。

根据当前国家政策规定：跨境电子商务零售进口商品的单次交易限值为人民币2000 元，个人年度交易限值为人民币2万元。当单次购买超过2000元（单仓）之后，就需要对订单拆单。

跨境电商一般是单品单仓，同一个SKU只在一个仓库有，而国内电商一般有多个区域仓，从时效最高的仓库发货。

在用户提交订单之后、支付之前的拆分订单，需要即时显示给用户，若用户中断支付，再回到支付环节，就需要分开支付，用户就能知道，是不同的包裹发过来的，分属不同的子订单。售后也是对子订单进行操作。

在支付之后，系统根据一些影响因素进行拆单，同一个子订单可能会对应多个物流单，在订单显示页面查看物流信息时，需要展示多个物流信息。但是现在许多平台只能一个订单对应一个物流单。有些订单商品数量过多或商品体积过大，一个包裹装不下。仓库分多包裹发货，反馈给前端就一个物流单号，信息反馈上就有些瑕疵。可以通过一个订单对应多包裹实现。

关于支付，虽然几乎所有平台都会通过合并支付的方式简化支付环节，但发起退款时还是会在原支付单号基础上，根据子订单分摊实付金额进行处理。

拆单的系统比较复杂，要做得非常完善，对于大部分电商公司来说，都有很大的困难，这需要打通从订单系统到WMS系统的许多环节。

当订单在“待发货”状态时，用户申请取消订单，由于用户在支付订单后，发货单可能已经推送至WMS，甚至已经交接发货，状态未及时回传更新。为避免货款两失，要先暂停订单出库，在调度中查询订单是否推送至仓库，若尚未推送，则停止推送；若已经推送，则去WMS拦截发货，暂停出库流程。若暂停失败，则拒绝“取消订单”申请，回复原因“订单已出库”；若暂停成功，“取消订单”申请通过，进入退款流程，同时通知调度中心该订单取消，WMS订单进入返库流程。

很多平台支持订单部分商品退款，这种情况下订单逆向流程比较复杂。当SKU全退时，原订单的状态直接变成“交易关闭”。当发生订单中部分商品退款时，原订单的状态不变，维持“待发货”状态，同时生成部分售后订单。

当订单在“待收货”或“交易成功”的状态时，用户申请退货。

用户提交退货申请之后，需经过客服审核。审核不通过，回到原状态；审核通过后，告知用户退货地址（仓库）或者上门取件，用户填写退货信息（物流单号等），才正式进入退货核心流程。系统生成退货入库单，当仓库收到退货之后，进行退款。

当订单在“待收货”或“交易成功”的状态时，用户申请退款，这时候会有一个疑问，都发货了为什么会允许仅退款不退货这种情形？这种情形偶尔会发生，如快递丢件、错发漏发、定制产品寄回来无用等。

在订单逆向流程处理时，涉及系统财务数据的变化，而每一次数据的变化，都不能直接在原数据上直接修改，而需要生成相应单据凭证。

纯服务订单是指线上购买服务，线下接受服务。

对于纯服务订单，当提交订单付款之后，系统生成核销码，如二维码或者一串字母数字组合。当用户到店接受服务之后，店铺进行核销，核销码失效，订单交易成功。

在系统中，可以将服务当作一种特殊类型的SKU来处理。例如购买了轮胎，赠送轮胎安装服务。将安装服务绑定到轮胎上，类似赠品。这类商品与服务之间的关系，可在商品中心进行维护。

订单数据统计分为常规统计和流量分析统计。

常规统计倾向于财务统计，主要包括销售额、毛利、成本、纯利润、客单价等。流量分析统计更多是为了指导电商平台运营工作，分析用户行为、订单流量等，如访客数、浏览量、支付转化率等。在订单流量分析中又分为三个维度，分别从订单交易纬度、商品纬度、订单来源等三方面来分析。

交易维度分析需要统计以下几个数据：
* 统计周期内的订单销售额；
* 订单量；
* 客单价；
* 下单用户数与支付用户数；
* 支付新用户数与支付老用户数；
* 订单金额分布；
* 地域分布；

商品维度分析需要统计以下数据：
* 被下单商品数；
* 被支付商品数；
* 被访商品数；（UV）
* 商品收藏次数；
* 商品销量统计；
* 加购件数；

订单来源分析需要统计以下数据。

订单的来源媒介（站外广告渠道）、用户端（APP、H5商城、PC端等）。

每个订单的产生流程，包括在订单创建之前的商品浏览、加入购物车、提交购物车等关键步骤的数据分析。

追踪订单来源，包括来源的媒介、来源关键词、来源网站等。

购物车在实际使用中对用户来说，兼具凑单、促销、收藏的功能。

离线购物车指的是用户在未登录状态下把商品加入购物车，一般通过创建虚拟用户实现。为了更好的用户体验，需要让用户在下单之前，允许未登录先将商品加入购物车。

用户登录之后，涉及离线购物车和在线购物车合并。首先判断当前是否有离线购物车，然后将离线购物车的数据和在线购物车的数据进行合并。

由于商品库存会发生变动，在库存紧张或无货的时候，会在前端给予提示。除了提醒用户，在库存紧张时还有促单的功效。购物车更新时，去查询对应的商品库存，判断当前商品的数量，当库存数大于0并小于提醒值时，提醒用户库存不足，请尽快下单；当库存数等于0时，提醒无货；当商品下架后，提示商品无效。

商品在购物车中显示有几个纬度：①商家店铺，将不同店铺的商品分开；②优惠不同，在购物车中将优惠活动相同的商品聚合在一起；③加入时间，按照加入购物车的时间倒序排列，最近添加的商品排列在前。

购物车中显示促销相关信息，类似满减、满赠、赠品等信息。例如在购物车中显示“满500减100”、“全场满减”、“商品的赠品有哪些”。还可以引导客户去店铺领取优惠券。在购物车中展示促销信息对提高客单价有良好效果，笔者认为目前最好用的购物车非京东莫属。

在购物车底部，是最好的商品宣传位，可以添加为商品推荐区域。墠A悀至于商品推荐的内容，会根据用户数据做定向推荐，这里不做扩展。

购物车的商品价格变动时给用户提示，比如降价20元，会对用户的消费决策产生影响。

编辑购物车时主要可以进行的操作：删除商品、加减商品数量、更改商品规格等。


# 第11章　其他系统综述
除了这些常见的系统，还有客服系统、财务管理系统、风控系统、TMS系统、商家管理后台（店铺管理）、会员系统、调度中心、支付系统、权限系统等。在内容电商的后台产品线中，还有管理用户内容（UGC）以及自运营内容的系统。

很少有电商企业能自己构建一套在线客服（包括智能机器人）、话务系统，一般都是使用第三方服务商的系统，如Udesk、七鱼等。

风控系统主要是防范账户风险、交易风险。在电商中最重要的是防作弊，包括恶意领取超值优惠券、恶意秒杀占用库存、商户刷单，还有用户会频繁购买，然后恶意退货退款，这些行为都会对平台造成损害。

商家管理后台是平台提供给商家用的系统，包括订单、商品、促销、CMS系统等，提供给平台商家来运营管理店铺，相当于另一个电商管理后台，很多功能可以将平台后台功能平移给商家后台。商家管理后台的功能丰富度、自主性会很大程度影响平台商家的积极性。

会员系统有一个升级版的名称：CRM（客户关系管理）系统。相比传统的会员系统，CRM系统是一套完整的客户关系开发、管理及流程管理的解决方案，赋予企业完善的客户交流能力，使客户收益率最大化。

会员系统主要分为针对C端和针对B端两种，相比传统企业的CRM系统，功能相对简单。针对C端的会员管理主要包含会员基础信息管理、会员成长体系和积分体系这三部分。针对B端业务的会员管理系统还涉及B端用户的组织架构管理、客户拓展等功能。

会员成长值是根据不同的成长策略进行量化赋分。

RFM模型是客户消费行为特征分析模型，RFM代表Recency（最近一次消费时间），Frequency（某一个时间范围内的消费频次），Monetary（某一个时间范围内的平均客单价或累计交易额）。RFM模型是衡量用户价值的重要工具和手段，是对会员价值进行多维度动态指标的综合加权计算。

RFM模型在衡量用户价值时，没有固定的计算方法，企业要根据平台的实际定位，对R、F、M这三个指标进行维度划分，对每个指标进行层次划分，并且给每个层次进行评分，这样R、F、M的值就分别评估出来，从而对其进行聚类定性描述。另外，根据RFM模型，可以实现对用户消费特性进行群体细分。

RFM模型还可以协助实现客户生命周期分析，例如F值突然下降幅度很大，就需要执行用户唤醒策略。

用户行为增长模型是指根据用户在平台上的行为，进行成长值量化，突出用户单次行为的贡献度，成长值是会员行为的单向累计的统计。在电商网站中，一般对用户的登录、购物、评价、晒单等行为进行成长值评估。

当然还有一些成长值回退策略，比如退货、评论被删等行为会使用户的相应成长值扣减回退。

通过用户行为增长模型来评价用户的成长值，在用户进入平台初期有很大的激励作用，但是后期乏力。当用户成长值较高、用户等级较高时，就很难再激励用户为了成长值持续购物。而RFM模型作为一个动态评估模型，当用户消费倾向下降时，成长值就会停滞不前甚至下降，能持续激励用户去消费。例如某用户已经成为了超级会员，但是半年没消费开始掉级，变成了普通会员，这样的降级动作就有可能重新唤醒用户。

目前主流的三种积分消费方式有：订单结算抵扣、积分商城购买商品、用户权益置换等，这样积分的生成和消耗就形成完整的闭环。

当电商平台上有店铺时，会员体系就变得立体。

用户（VIP1～VIP7）属于平台的会员；同时用户在平台上的店铺发生过消费，又属于店铺的会员；甚至有会员属于不同店铺的会员。

会员系统是运营工作的载体，通过会员等级特权及积分激励的手段来达到促进用户购物、提高用户黏性的目的。

会员系统有很大扩展性，可以给用户加会员标签、进行人群画像分组、执行不同的营销策略，还可以把线上店铺、线下门店纳入到会员管理体系（CRM）中，提供给销售业务人员进行客户开发、客户跟踪。

调度中心在整个电商系统中起到的是承上启下的中介作用，类似一个中央处理器。举个简单例子，系统将用户买了哪些商品、收货地址告诉调度中心，调度中心就会输出结果：从哪些仓库发货，用什么物流发货，多长时间能到。

由于大部分电商企业没有支付牌照，自建支付产品的可能性较小，所以此处的讨论范围仅限于接入支付服务的范畴。


# 第12章　跨境电商的不同点
随着政策的逐步完善，跨境电商试点城市逐步增加，电商可凭交易记录和出口物流凭证即可结汇、快速清关等政策，都支撑着跨境电商的快速发展。

主要模式有三种：保税仓备货、海外直邮、一般贸易等。

保税仓指的是存放未交关税的仓库，如同境外仓库。当用户购买付款后，向海关申报，海关放行之后，直接从保税仓发货，再收取关税。

保税仓对于跨境电商企业的优势在于提高通关速度、减少资金占用、降低贸易成本，还可以随时转口，方便快捷。可以享受一定的便捷和免税政策。

海外直邮指的是将商品直接从海外邮寄到用户手中。直邮模式不用压货，由海外供应商直接发货，许多海外品牌商和零售商都在试水跨境进口电商。例如天猫国际上的许多品牌店。受四八新政影响以及扩充品类的需求，许多跨境电商企业都建有海外仓，或是直接从海外供应商发货。海外直邮的商品需要通过两个国家的海关，再加上运输时间，一般需要2～4周用户才能收到商品。

海外直邮有两种方式，一种是个人物品直邮入境，不受通关单的限制，由快递公司正常报关、商检（抽查形式），许多时候可以合理避税。另一种方式是正常的报关清关，完税价格超过2000元限值的商品订单先在海外集货，然后按照一般贸易方式清关，全额缴税。低于2000元限值的商品类似保税仓商品清关流程，三单与清单对碰。现在提倡“阳光海淘”，从长远发展考虑，电商企业还是走正常的清关流程比较合理。

一般贸易指的是先将跨境商品进口至国内，以完税价格出售。

一般贸易的完税商品和国内一般商品的购物流程无差别。

海外直邮：对于转运物流公司而言，通关能力（避税能力）是第一要素，几乎所有的转运公司都是以个人邮寄物品形式报关。其中有抽查的概率问题，没抽到就不用交税。

保税仓：目前政策规定跨境电子商务零售进口商品的单次交易限值为人民币2000元，个人年度交易限值为人民币20000元。

保税仓的税费组成包括三部分：进口环节增值税、消费税、关税。䅀`怀关税暂设为0％，进口环节增值税、消费税取消免征税额暂按法定应纳税额的70％征收。其中消费税一般为0，只有少数奢侈品收取消费税；进口环节增值税一般为17％，少数品类有所不同，比如农副产品。

跨境电商综合税率＝（消费税率＋增值税率）/（1-消费税率）×0.7（因政策改变可能会发生变化）。


最常见的综合税率是11.9％（17％×0.7）。例如从某平台上购买800 元的奶粉，则税费＝800×11.9％＝95.2元。此税费为收取用户的税费。

备案价其实涉及向海关报关的一种策略，也可以说是一个保险价格。一般情况下，报关时需要拿订单向海关报关，如果商品价格变动幅度过大，有可能被怀疑偷税漏税，所以一般保税仓物品不要参加优惠幅度较大的活动。另一种方案是，设置一个备案价，将订单中商品价格与备案价对比，变动幅度过大时，按照备案价去申报。

例如：A商品原价50元，参加双十一秒杀活动价9.9元，从保税仓出库。由于商品实付金额区别太大，税费差距较为明显，算来同一商品你交税少了很多，可能被海关质疑：你是不是偷税漏税了？所以这时候就需要用备案价去申报。

订单对应的支付单，由支付公司推送给跨境通关服务平台。需要专门的跨境交易的国内卖家建立的资金账户管理平台，例如微信国际支付和支付宝国际支付。

进口清单：又称为个人物品申报单，包含订单、商品、支付、物流的相关信息。“三单”主要和进口清单进行数据对碰。

查询跨境电子商务年度个人额度网址：http://ceb2pub.chinaport.gov.cn

保税仓的拆单要在下单时支付前完成。由于报关时需要的一系列详细订单信息，下单时就做好订单拆分是最优解。

订单出库流程要在清关通过之后进行。在海关审核时，会由于各种原因造成清关不通过（海关退单、退运等），这时候需要人工介入。最常见的退回原因是身份证校验不通过，这时候需要客服联系用户提供正确身份证信息。

海关计税是以清关单申报的价格计税，订单申报价格与清关单申报价格需要一致才能通关，支付单的价格可以与清单及订单的价格不同，但是不允许大于清关单的价格。

由于区域规定不同，有些地区是直接与海关总署对接，有些地区是与地方的跨境通关服务平台（电子口岸）对接。

保税仓所卖的商品都需要在国检（出入境检验检疫机构）进行备案，才能进保税仓，才能出保税区。

当订单清关通过之后，会形成一份税单。每个月海关为电商企业形成一份大税单，与电商企业结算，海关会从保证金中扣除。

# 后记
做电商以来，一直有个疑问。电商企业的后台系统同质化严重，比如订单、商品、库存等，而电商公司都喜欢从0开发，甚至直到倒闭还在做从0到1的开发工作，绝大部分产品经理和开发人员都是在做重复劳动，浪费了极大的人力物力。有没有可能将这些模块做成类似水、电一样的基础开源模块，流程标准化，解放这些开发资源去做更有意义的事情？







